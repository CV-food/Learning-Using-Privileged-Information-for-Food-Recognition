Downloading: "https://download.pytorch.org/models/resnet50-19c8e357.pth" to /root/.cache/torch/hub/checkpoints/resnet50-19c8e357.pth
  0%|          | 0.00/97.8M [00:00<?, ?B/s]  0%|          | 40.0k/97.8M [00:00<08:33, 200kB/s]  0%|          | 104k/97.8M [00:00<07:33, 226kB/s]   0%|          | 168k/97.8M [00:00<06:05, 280kB/s]  0%|          | 240k/97.8M [00:00<04:59, 342kB/s]  0%|          | 352k/97.8M [00:00<03:58, 428kB/s]  1%|          | 512k/97.8M [00:00<03:06, 546kB/s]  1%|          | 752k/97.8M [00:00<02:23, 710kB/s]  1%|          | 1.05M/97.8M [00:01<01:49, 925kB/s]  2%|▏         | 1.50M/97.8M [00:01<01:22, 1.22MB/s]  2%|▏         | 2.16M/97.8M [00:01<01:01, 1.62MB/s]  3%|▎         | 2.99M/97.8M [00:01<00:46, 2.14MB/s]  4%|▍         | 4.31M/97.8M [00:01<00:34, 2.86MB/s]  6%|▌         | 5.99M/97.8M [00:01<00:25, 3.82MB/s]  7%|▋         | 7.33M/97.8M [00:01<00:19, 4.89MB/s]  9%|▉         | 8.99M/97.8M [00:01<00:14, 6.23MB/s] 11%|█         | 10.3M/97.8M [00:01<00:12, 7.48MB/s] 12%|█▏        | 12.0M/97.8M [00:01<00:09, 9.02MB/s] 14%|█▎        | 13.4M/97.8M [00:02<00:08, 9.91MB/s] 16%|█▌        | 15.2M/97.8M [00:02<00:07, 11.5MB/s] 17%|█▋        | 16.7M/97.8M [00:02<00:07, 11.4MB/s] 19%|█▉        | 18.7M/97.8M [00:02<00:06, 13.2MB/s] 21%|██        | 20.2M/97.8M [00:02<00:06, 12.7MB/s] 22%|██▏       | 21.8M/97.8M [00:02<00:05, 13.6MB/s] 24%|██▍       | 23.2M/97.8M [00:02<00:05, 14.1MB/s] 25%|██▌       | 24.8M/97.8M [00:02<00:05, 14.6MB/s] 27%|██▋       | 26.3M/97.8M [00:02<00:05, 14.8MB/s] 28%|██▊       | 27.8M/97.8M [00:03<00:04, 15.2MB/s] 30%|██▉       | 29.3M/97.8M [00:03<00:04, 15.3MB/s] 32%|███▏      | 30.8M/97.8M [00:03<00:04, 15.5MB/s] 33%|███▎      | 32.3M/97.8M [00:03<00:04, 15.4MB/s] 35%|███▍      | 33.9M/97.8M [00:03<00:04, 15.6MB/s] 36%|███▌      | 35.4M/97.8M [00:03<00:04, 15.6MB/s] 38%|███▊      | 36.9M/97.8M [00:03<00:04, 15.7MB/s] 39%|███▉      | 38.4M/97.8M [00:03<00:03, 15.6MB/s] 41%|████      | 40.0M/97.8M [00:03<00:03, 15.7MB/s] 42%|████▏     | 41.5M/97.8M [00:03<00:03, 15.7MB/s] 44%|████▍     | 43.0M/97.8M [00:04<00:03, 15.6MB/s] 46%|████▌     | 44.5M/97.8M [00:04<00:03, 15.7MB/s] 47%|████▋     | 46.0M/97.8M [00:04<00:03, 15.6MB/s] 49%|████▊     | 47.6M/97.8M [00:04<00:03, 15.7MB/s] 50%|█████     | 49.1M/97.8M [00:04<00:03, 15.7MB/s] 52%|█████▏    | 50.6M/97.8M [00:04<00:03, 15.8MB/s] 53%|█████▎    | 52.1M/97.8M [00:04<00:03, 15.7MB/s] 55%|█████▍    | 53.6M/97.8M [00:04<00:02, 15.7MB/s] 56%|█████▋    | 55.1M/97.8M [00:04<00:02, 15.7MB/s] 58%|█████▊    | 56.6M/97.8M [00:04<00:02, 15.7MB/s] 59%|█████▉    | 58.1M/97.8M [00:05<00:02, 15.7MB/s] 61%|██████    | 59.6M/97.8M [00:05<00:02, 15.6MB/s] 63%|██████▎   | 61.2M/97.8M [00:05<00:02, 15.8MB/s] 64%|██████▍   | 62.7M/97.8M [00:05<00:02, 15.7MB/s] 66%|██████▌   | 64.2M/97.8M [00:05<00:02, 15.8MB/s] 67%|██████▋   | 65.7M/97.8M [00:05<00:02, 15.7MB/s] 69%|██████▉   | 67.3M/97.8M [00:05<00:02, 15.8MB/s] 70%|███████   | 68.8M/97.8M [00:05<00:01, 15.7MB/s] 72%|███████▏  | 70.3M/97.8M [00:05<00:01, 15.6MB/s] 73%|███████▎  | 71.8M/97.8M [00:05<00:01, 15.7MB/s] 75%|███████▌  | 73.3M/97.8M [00:06<00:01, 15.6MB/s] 77%|███████▋  | 74.8M/97.8M [00:06<00:01, 15.5MB/s] 78%|███████▊  | 76.4M/97.8M [00:06<00:01, 15.7MB/s] 80%|███████▉  | 77.9M/97.8M [00:06<00:01, 15.4MB/s] 81%|████████▏ | 79.6M/97.8M [00:06<00:01, 15.9MB/s] 83%|████████▎ | 81.1M/97.8M [00:06<00:01, 15.5MB/s] 85%|████████▍ | 82.7M/97.8M [00:06<00:00, 16.0MB/s] 86%|████████▌ | 84.2M/97.8M [00:06<00:00, 15.6MB/s] 88%|████████▊ | 85.8M/97.8M [00:06<00:00, 15.8MB/s] 89%|████████▉ | 87.4M/97.8M [00:07<00:00, 15.6MB/s] 91%|█████████ | 88.9M/97.8M [00:07<00:00, 15.1MB/s] 93%|█████████▎| 90.7M/97.8M [00:07<00:00, 16.0MB/s] 94%|█████████▍| 92.2M/97.8M [00:07<00:00, 15.3MB/s] 96%|█████████▌| 93.8M/97.8M [00:07<00:00, 15.6MB/s] 97%|█████████▋| 95.2M/97.8M [00:07<00:00, 15.5MB/s] 99%|█████████▉| 96.8M/97.8M [00:07<00:00, 15.7MB/s]100%|██████████| 97.8M/97.8M [00:07<00:00, 13.3MB/s]lr : 0.001
Training starts..

Traceback (most recent call last):
  File "train.py", line 377, in <module>
    train_epoch(epoch, lr_decay, train_stage)
  File "train.py", line 190, in train_epoch
    x_recon = model(data)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 155, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 165, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/parallel_apply.py", line 85, in parallel_apply
    output.reraise()
  File "/opt/conda/lib/python3.7/site-packages/torch/_utils.py", line 395, in reraise
    raise self.exc_type(msg)
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/parallel_apply.py", line 60, in _worker
    output = module(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/code/CV_pj/Learning-Using-Privileged-Information-for-Food-Recognition/mymodel.py", line 64, in forward
    x_latent, a = self.encoder_v(x)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/code/CV_pj/Learning-Using-Privileged-Information-for-Food-Recognition/resnet.py", line 153, in forward
    x = self.layer4(x)  # ／2
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/code/CV_pj/Learning-Using-Privileged-Information-for-Food-Recognition/resnet.py", line 89, in forward
    residual = self.downsample(x)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 419, in forward
    return self._conv_forward(input, self.weight)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 416, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 11.91 GiB total capacity; 2.46 GiB already allocated; 7.94 MiB free; 2.48 GiB reserved in total by PyTorch)

